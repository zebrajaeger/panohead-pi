#pragma once

#include <Arduino.h>
#include <Wire.h>

#include "types.h"

class WireUtils
{
public:
    // -----------------------------------------------------------------------------
    static bool read24(u32_t &value)
    // -----------------------------------------------------------------------------
    {
        if (Wire.available() >= 2)
        {
            value.bytes[3] = 0;
            uint8_t res = Wire.readBytes(&value.bytes[0], 3);
            return res == 3;
        }
        return false;
    }

    // -----------------------------------------------------------------------------
    static bool read32(u32_t &value)
    // -----------------------------------------------------------------------------
    {
        if (Wire.available() >= 3)
        {
            uint8_t res = Wire.readBytes(&value.bytes[0], 4);
            return res == 4;
        }
        return false;
    }

    // -----------------------------------------------------------------------------
    static bool read64(u64_t &value)
    // -----------------------------------------------------------------------------
    {
        if (Wire.available() >= 7)
        {
            uint8_t res = Wire.readBytes(&value.bytes[0], 8);
            return res == 8;
        }
        return false;
    }

    // -----------------------------------------------------------------------------
    static void writeBool(bool b)
    // -----------------------------------------------------------------------------
    {
        Wire.write(b ? 1 : 0);
    }

    // -----------------------------------------------------------------------------
    static void write8(const u8_t u8)
    // -----------------------------------------------------------------------------
    {
        Wire.write(&u8.bytes[0], 1);
    }

    // -----------------------------------------------------------------------------
    static void write16(const u16_t u16)
    // -----------------------------------------------------------------------------
    {
        Wire.write(&u16.bytes[0], 2);
    }

    // -----------------------------------------------------------------------------
    static void write24(const u32_t u32)
    // -----------------------------------------------------------------------------
    {
        Wire.write(&u32.bytes[0], 3);
    }

    // -----------------------------------------------------------------------------
    static void write32(const u32_t u32)
    // -----------------------------------------------------------------------------
    {
        Wire.write(&u32.bytes[0], 4);
    }

    // -----------------------------------------------------------------------------
    static void write64(const u64_t &u64)
    // -----------------------------------------------------------------------------
    {
        Wire.write(&u64.bytes[0], 8);
    }
};